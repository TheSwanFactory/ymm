# - install
# - test
# - watch
# - release
# - dev

init:
    MSG: echo "Init"
    VERSION: cat version.txt

build:
    - pip3 install --upgrade pytest
    - pip3 install --upgrade pytest-watch
    - pip3 install --upgrade build
    - pip3 install --upgrade twine

test-install:
    - $install
    - ymm -v
    - ymm -d echo

echo:
    SELF: echo "echo"
    DATE: date -u +"%Y-%m-%dT%H:%M:%SZ"
    ECHO: echo {DATE}

release:
    - prerelease --no-input
    - release --no-input
    - python3 -m build
    - python3 -m twine upload dist/*
    - postrelease --no-input

bump-dev:
   NEW: awk -Fv {{printf("%sv%d\n",$1,$2+1)}} version.txt
   UPDATED: sed -i .prev s/{version}/{new}/ version.txt

reinstall:
    - $bump-dev
    - $test-install

dev:
    - $bump-dev
    - git commit -am {version}
    - git push
